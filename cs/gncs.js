!function(w,d){let that;const contentType="application/json; charset=utf-8",XHR_JQ_CODE=101,XHR_JQ_URL="/magic/oauth/login",DEFAULT_AUTH_USER={zh:"",mm:""};function setPageTemp(val,callBack,param=void 0){return val||callBack(param)}const urlPattern=/\/webs\/|\/public\/|\/public21\/|\/public23\/|\/lib\/|\/lib21\/|\/lib23\/|\/.+\[^\/].js|\/[^/]+\.html/;var appBaseUrl,serverUrl;function setAppBaseUrl(){let url=location.href;return appBaseUrl=(url.split(urlPattern)[0]+"/").replace(/\/+/g,"/")}function getAppBaseUrl(){return setPageTemp(appBaseUrl,setAppBaseUrl)}const webName=`/${getAppBaseUrl().split("/").filter(Boolean)}/`;function session(name,val){const name1=webName+name;return void 0===val?JSON.parse(sessionStorage.getItem(name1)||sessionStorage.getItem(name)||"null"):(null===val?(sessionStorage.removeItem(name),sessionStorage.removeItem(name1)):sessionStorage.setItem(name1,JSON.stringify(val)),val)}var user,configData,Authorization="";function errFormat(message,code=-1){return{code:code,message:message,data:{}}}function setUser(){return user=session("userinfo")}function setConfigData(){return configData=getAjax("/public/data/config.json",{v:(new Date).getTime()},{msg:"获取配置信息出错：",urlType:"origin",isNotGetUser:!0})}function getUser(){setPageTemp(user,setUser)}function convertToAbsoluteUrl(relativeUrl,base){if(/^http[s]*:\/\//i.test(relativeUrl))return relativeUrl;const baseAddress=function(relativeUrl){if(relativeUrl instanceof URL||relativeUrl instanceof Location)return relativeUrl;if("string"==typeof relativeUrl)try{return new URL(relativeUrl)}catch(error){console.error("Invalid URL:",relativeUrl)}return location}(base);let pathParts=baseAddress.pathname.split("/").filter(Boolean);if((relativeUrl=relativeUrl.replace(/^\.\//,"").replace(/\/$/,"")).startsWith("../")){const levelUp=relativeUrl.split("/").filter((part=>".."===part)).length;pathParts=pathParts.slice(0,-levelUp),relativeUrl=relativeUrl.replace(/\.\.\//g,"")}return pathParts=pathParts.concat(relativeUrl.split("/").filter(Boolean)),baseAddress.origin+"/"+pathParts.join("/")}function encodeUrlParamValue(value){return value?encodeURIComponent("object"==typeof value?JSON.stringify(value):value):""}function setServerUrl(){return serverUrl=function(urlsArray){if("string"==typeof urlsArray)return urlsArray;for(var index=0;index<urlsArray.length;index++)if(urlsArray[index].includes(location.origin))return urlsArray[index];return urlsArray[0]}(function(key=""){return setPageTemp(configData,setConfigData),key?configData[key]:configData}().magicServer)}function buildAbsoluteUrl(targetUrl,urlType){return/^http/.test(targetUrl)?targetUrl:convertToAbsoluteUrl(targetUrl,"origin"===urlType?getAppBaseUrl():setPageTemp(serverUrl,setServerUrl))}function buildUrlWithQueryParams(obj,url=""){return url?function(obj,url){const baseUrl=new URL(url),searchParams=new URLSearchParams(baseUrl.search);return Object.entries(obj).forEach((([key,value])=>{searchParams.set(key,encodeUrlParamValue(value))})),baseUrl.search=searchParams.toString(),url.toString()}(obj,url):function(obj){return Object.entries(obj).map((([key,value])=>`${key}=${encodeUrlParamValue(value)}`)).join("&")}(obj)}const ajaxTimeOut=18e4,ajaxRerr={400:"客户端请求的语法错误，服务器无法理解请求",401:"请求要求用户进行身份认证",403:"服务器已接受客户端的请求，但是拒绝执行此请求。",404:"请求服务不存在",408:"请求超时",409:"请求的资源与服务器中的资源冲突",413:"请求内容过大，超出服务器允许的范围",415:"服务器无法处理请求附带的媒体格式",500:"服务器遇到了不知道如何处理的情况",502:"作为网关或代理工作的服务器从上游服务器收到了无效的响应",503:"服务器目前无法使用（由于超载或停机维护）",504:"作为网关或代理的服务器未能及时从上游服务器收到请求"};function dealXhrRes(xhr){if(!(xhr.status>=200&&xhr.status<300))return errFormat("请求失败："+ajaxRerr[xhr.status]);try{var data=JSON.parse(xhr.responseText);return data.message=data.message||data.msg,data.code="1"===data.code?1:data.code,data}catch(e){return xhr.responseText}}function setXhr(url,type,{urlType:urlType,isCheck:isCheck},param,config,async,isRest){isCheck&&that.checkAuth&&that.checkAuth(config,url,isRest),url=buildUrlWithQueryParams(param,url=buildAbsoluteUrl(url,urlType));const xhr=new XMLHttpRequest;return xhr.open(type,url,async),xhr.setRequestHeader("Content-Type",contentType),xhr}function sync(url,data={},param={},option={},config={},type,isRest=!1){try{const xhr=setXhr(url,type,option,param,config,!1,isRest),time=setTimeout((()=>{xhr.abort()}),ajaxTimeOut);xhr.send(data),clearTimeout(time);const val=dealXhrRes(xhr);return option.isCheck&&val.code===XHR_JQ_CODE?sync(url,data,param,option,config,type,!0):val}catch(e){return errFormat("请求过程中发生错误："+(e.message||e))}}function getAjax(url,data,option={},config={}){return sync(url,option.param,data,option,config,"GET")}function async(url,data={},param={},option={},config={},type,isRest=!1){return new Promise(((resolve,reject)=>{try{const xhr=setXhr(url,type,option,param,config,!0,isRest);xhr.timeout=ajaxTimeOut,xhr.onload=()=>{const val=dealXhrRes(xhr);option.isCheck&&val.code===XHR_JQ_CODE?resolve(async(url,data,param,option,config,type,!0)):resolve(val)},xhr.onerror=()=>{reject(errFormat("请求失败：网络错误"))},xhr.ontimeout=()=>{reject(errFormat("请求失败：网络连接超时"))},xhr.send(data)}catch(e){return reject(errFormat("请求过程中发生错误："+(e.message||e)))}}))}function dealRequestData(data,option={},config={},type="POST"){if(option.isCheck,that&&that.dealAjaxData)return that.dealAjaxData(data,option,config,type);if(!option.isNotGetUser){const user=getUser();data=Object.assign({},{czryid:user.ryid,czryjgid:user.jgid,czryjgmc:user.jgmc,czryjgjc:user.jgjc,czryyhm:user.yhm,czryxm:user.xm||user.username,superadmin:user.superadmin},data)}return option.isNotWrapped?JSON.stringify(data):JSON.stringify({data:data})}function commonHttppost(url,data,option={},config={}){return sync(url,dealRequestData(data,option,config),option.param,option,config,"POST")}const Class=function(){that=this,w.layui&&layui.use(["layer"])};Class.prototype={asyncGetPost:function(url,data,option={},config={}){return async(url,option.param,data,option,config,"GET")},asyncQueryPost:function(url,data,option={},config={}){return async(url,dealRequestData(data,option,config),option.param,option,config,"POST")},getAjax:getAjax,commonHttppost:commonHttppost,checkAuth:function(config,option,url,reset=!1){url!==XHR_JQ_URL&&(!reset&&Authorization||(option.isCheck=!1,function(){try{const user=session("magicUser")||(session("magic")||{}).user||DEFAULT_AUTH_USER,res=commonHttppost(XHR_JQ_URL,user,{isNotGetUser:!0,isNotWrapped:!0})||{};Authorization=res.data.accessToken||!0}catch(e){Authorization=!0}}()),config.headers=config.headers||{},config.headers.accessToken=!0===Authorization?void 0:Authorization)}},w.jtUtil=new Class}(window,document),jtUtil.asyncQueryPost("/magic/jcgl/other/s-bjg",{bm:"sqldy"},{isNotGetUser:!0});